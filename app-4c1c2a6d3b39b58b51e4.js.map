{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/layout/Navbar.tsx","webpack:///./src/assets/signal-logo.png","webpack:///./src/etc/constants.ts","webpack:///./src/lib/convert-image.ts","webpack:///./src/lib/stickers.ts","webpack:///./src/lib/signal.ts","webpack:///./src/etc/stickers-proto.ts","webpack:///./src/contexts/StickersContext.tsx","webpack:///./src/components/home/SearchInput.tsx","webpack:///./src/components/home/StickerPackPreviewCard.tsx","webpack:///./src/components/home/SearchResults.tsx","webpack:///./src/components/home/Home.tsx","webpack:///./src/components/pack/Sticker.tsx","webpack:///./src/components/pack/StickerPackError.tsx","webpack:///./src/components/pack/Tag.tsx","webpack:///./src/components/pack/StickerPackDetail.tsx","webpack:///./src/hooks/use-query.ts","webpack:///./src/components/layout/FlexSpacer.tsx","webpack:///./src/components/layout/Footer.tsx","webpack:///./src/components/contribute/Contribute.tsx","webpack:///./src/components/App.tsx","webpack:///./src/lib/utils.ts","webpack:///./src/index.tsx","webpack:///./src/lib/crypto.ts","webpack:///./src/lib/error.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","0","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","StyledNavBar","className","to","src","alt","title","href","BOOTSTRAP_BREAKPOINTS","xs","sm","md","lg","xl","webp","Webp","Module","doNotCaptureKeyboard","webpConverter","WebpMachine","webpSupport","detectWebpSupport","detectWebpImage","defaultDetectWebpImage","hasWebpSupportPromise","imageConversionQueue","pQueue","concurrency","convertImage","rawImageData","a","base64Data","btoa","String","fromCharCode","undefined","add","pWaitFor","busy","decode","console","error","message","stickerPackDirectoryPromise","packMessage","protobuf","Root","fromJSON","nested","Pack","fields","type","id","author","cover","stickers","rule","options","Sticker","emoji","root","lookupType","stickerPackManifestCache","Map","stickerImageCache","parseManifest","rawManifest","decryptManifest","manifest","manifestData","Uint8Array","byteLength","ErrorWithCode","code","stack","getStickerPackManifest","has","set","Promise","resolve","reject","axios","method","responseType","url","res","getStickerInPack","stickerId","cacheKey","stickerManifest","rawWebpData","getEmojiForSticker","packManifest","sticker","find","curSticker","Error","stickerPackCache","LocalForage","createInstance","storeName","getStickerPackDirectory","request","getStickerPack","directory","partial","R","meta","finalKey","stickerPack","isAxiosError","response","status","isStorageUnavailableError","err","Boolean","curPattern","getConvertedStickerInPack","convertedImage","getItem","setItem","Context","createContext","Provider","props","useState","searchQuery","setSearchQuery","searchResults","setSearchResults","allStickerPacks","setAllStickerPacks","useAsyncEffect","stickerPacks","useEffect","needle","haystack","rawSearchResults","FuzzySearch","caseSensitive","sort","search","children","SearchInput","useContext","breakpoint","useBreakpoint","debouncedSetSearchQuery","debounceFn","wait","setSearchQueryInputValue","event","tags","suggestedTags","tag","onClick","placeholder","cx","includes","onChange","aria-label","autoComplete","spellCheck","StickerPackPreviewCard","coverImage","setCover","nsfw","StickerPackList","renderedSearchResults","setCursor","newCursor","cursor","setRenderedSearchResults","loadMore","onEnter","bottomOffset","HomeComponent","packId","packKey","setEmoji","setStickerSrc","StickerPackError","Tag","StickerPackDetail","LinkifyHrefDecorator","decoratedHref","target","rel","useParams","URLSearchParams","useLocation","useQuery","setStickerPack","setStickerPackError","source","numStickers","stickerPackTags","addToSignalHref","componentDecorator","FooterWrapper","Footer","Contribute","SIGNAL_ART_URL_PATTERN","TAGS_PATTERN","initialValues","signalArtUrl","isNsfw","validators","matches","RegExp","exec","test","onSubmitClick","setHasBeenSubmitted","setYmlBlob","setPreviewUrl","onSubmit","values","validateOnChange","validateOnBlur","isSubmitting","noValidate","errors","htmlFor","validate","checked","disabled","ymlBlob","App","basename","Navbar","exact","path","Home","storageEstimate","idbUsage","usageDetails","indexedDB","quota","percentageUsed","toFixed","debug","bytes","printStorageUsage","ReactDOM","render","document","getElementById","IS_BROWSER","hexToArrayBuffer","hexString","tmpHexString","parseInt","substring","deriveKeys","encodedKey","hash","salt","ArrayBuffer","info","crypto","subtle","importKey","masterKey","algorithm","TextEncoder","encode","derivedKeyAlgorithm","deriveKey","derivedKeys","exportKey","derivedKeyBytes","Buffer","from","hkdf","compute","derivedKey","keys","encryptedManifest","theirIv","cipherTextBody","theirMac","combinedCipherText","macKey","verify","cipherKey","decrypt","iv","aesKey","hmacKey","toString","computedMac","createHmac","update","digest","decipher","createDecipheriv","concat","errWithCode"],"mappings":"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","file":"app-4c1c2a6d3b39b58b51e4.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import React from 'react';\nimport {Link} from 'react-router-dom';\nimport {styled} from 'linaria/react';\n// @ts-ignore (No type definitions exist for this package.)\nimport Octicon from 'react-octicon';\n\nimport SignalLogoUrl from 'assets/signal-logo.png';\nimport {SIGNAL_BLUE} from 'etc/colors';\n\n\n// ----- Styles ----------------------------------------------------------------\n\nconst StyledNavBar = styled.nav`\n  background-color: ${SIGNAL_BLUE};\n  color: white;\n  padding: 8px 0;\n\n  & .brand {\n    font-size: 28px;\n    font-weight: 400;\n    color: white;\n\n    &:hover {\n      color: white;\n      text-decoration: none;\n    }\n\n    & img {\n      bottom: 2px;\n      height: 32px;\n      position: relative;\n      width: 32px;\n    }\n  }\n`;\n\n\n// ----- Component -------------------------------------------------------------\n\nconst NavbarComponent: React.FunctionComponent = () => {\n  return (\n    <>\n      <StyledNavBar>\n        <div className=\"container\">\n          <div className=\"row\">\n            <div className=\"col-12 col-md-6 text-center text-md-left mb-2 mb-sm-1\">\n              <Link className=\"brand\" to=\"/\"><img src={SignalLogoUrl} alt=\"Signal Logo\" /> Signal Stickers</Link>\n            </div>\n            <div className=\"col-12 col-md-6 text-center text-md-right mt-2 mb-2 mb-md-0\">\n              <Link to=\"/contribute\" title=\"Contribute\">\n                <button className=\"btn btn-light btn-sm mr-3\"><Octicon name=\"plus\" />&nbsp;Contribute</button>\n              </Link>\n              <a href=\"https://signal.org\" title=\"Get Signal\">\n                <button className=\"btn btn-primary btn-sm\">Get Signal</button>\n              </a>\n            </div>\n          </div>\n        </div>\n      </StyledNavBar>\n    </>\n  );\n};\n\n\nexport default NavbarComponent;\n","export default \"data:image/png;base64,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\"","/**\n * Mapping of Bootstrap 4 breakpoint names to their minWidths.\n */\nexport const BOOTSTRAP_BREAKPOINTS = {\n  xs: 0,\n  sm: 576,\n  md: 768,\n  lg: 992,\n  xl: 1200\n};\n","/**\n * ===== Image Converter =======================================================\n *\n * This module is responsible for converting WebP images to PNG images on\n * browsers that do not support WebP. Because we will be getting multiple\n * simultaneous calls to this function when the site loads, we use an\n * asynchronous task queue to limit concurrency of image conversion jobs.\n */\nimport pQueue from 'p-queue';\nimport pWaitFor from 'p-wait-for';\nimport {\n  WebpMachine,\n  detectWebpSupport,\n  defaultDetectWebpImage\n} from 'webp-hero';\nimport {Webp} from 'webp-hero/libwebp/dist/webp.js';\n\n\n// ----- Fixed Webp Instance ---------------------------------------------------\n\n/**\n * One of Webp Hero's dependencies seems to block user input when a conversion\n * is run. This fix can be found here:\n *\n * https://github.com/chase-moskal/webp-hero/issues/18#issuecomment-560188272\n */\nconst webp = new Webp();\nwebp.Module.doNotCaptureKeyboard = true;\n\n\n// ----- Locals ----------------------------------------------------------------\n\n/**\n * Module-local WepP to PNG converter.\n */\nconst webpConverter = new WebpMachine({\n  webp,\n  webpSupport: detectWebpSupport(),\n  detectWebpImage: defaultDetectWebpImage\n});\n\n/**\n * Ensures we check for WebP support only once.\n */\nconst hasWebpSupportPromise = detectWebpSupport();\n\n/**\n * Module-local asynchronous queue facility that will allow us to limit the\n * number of concurrent image conversion operations.\n */\nconst imageConversionQueue = new pQueue({concurrency: 1});\n\n\n// ----- Functions -------------------------------------------------------------\n\n/**\n * Resolves with `true` if the browser supports WebP or `false` otherwise.\n */\nexport async function hasWebpSupport() {\n  return hasWebpSupportPromise;\n}\n\n\n/**\n * If the browser has WebP support, the image data is converted into a base-64\n * encoded string and returned. Otherwise, the image is converted to PNG using\n * webp-hero and returned as a base-64 encoded string. Both variants are\n * suitable for using in the \"src\" attribute of an img tag.\n */\nexport async function convertImage(rawImageData: Uint8Array) {\n  if (await hasWebpSupportPromise) {\n    // If the browser supports WebP, we don't need to convert it to PNG.\n    const base64Data = btoa(String.fromCharCode.apply(undefined, rawImageData));\n    return `data:image/webp;base64,${base64Data}`;\n  }\n\n  // Otherwise, convert the WEBP image to PNG. This will take a noticeable\n  // amount of time/memory on the user's machine, but is the only way we can\n  // display these images at this time.\n  return imageConversionQueue.add(async () => {\n    try {\n      // @ts-ignore (`busy` is not an exposed member of WebpMachine.)\n      await pWaitFor(() => webpConverter.busy === false);\n\n      return await webpConverter.decode(rawImageData);\n    } catch (err) {\n      console.error(`[convertImage] Image conversion failed: ${err.message}`);\n      throw err;\n    }\n  });\n}\n","// ===== Stickers Module =======================================================\n\n/**\n * This module contains several functions for loading, fetching, decrypting, and\n * caching stickers. Most notably, we fall back to a WebP-toPNG conversion when\n * on browsers that do not natively support WebP. It should be noted that this\n * process is time/CPU intensive and can cause have a significant performance\n * impact on the user's experience. Through queueing and max concurrency\n * settings, Safari seems to be able to handle this load without issue (albeit\n * far more slowly than Chrome).\n */\nimport axios from 'axios';\nimport FuzzySearch from 'fuzzy-search';\nimport LocalForage from 'localforage';\nimport * as R from 'ramda';\n\nimport {StickerPack, StickerPackPartial} from 'etc/types';\nimport {convertImage} from 'lib/convert-image';\nimport ErrorWithCode from 'lib/error';\n\nimport {\n  getStickerPackManifest,\n  getStickerInPack,\n  getEmojiForSticker\n} from 'lib/signal';\n\n\n// ----- Locals ----------------------------------------------------------------\n\n/**\n * Promise that will resolve with the list of sticker packs enumerated in\n * stickers.yaml. This collection will contain only those data from a\n * StickerPack that we want to search on or that we need to display a sticker\n * pack preview card. We use a promise here rather than the array itself to\n * ensure that if multiple calls to getStickerPackDirectory are made before the\n * initial request for stickerData.json resolves, we only make a single request\n * and only populate the directory once.\n */\nlet stickerPackDirectoryPromise: Promise<Array<StickerPackPartial>>;\n\n\n/**\n * In-memory cache of StickerPack objects.\n */\nconst stickerPackCache = new Map<string, StickerPack>();\n\n\n/**\n * Module-local browser-storage-backed cache used for sticker image data.\n */\nconst stickerImageCache = LocalForage.createInstance({\n  name: 'Signal Stickers',\n  storeName: 'Image Cache'\n});\n\n\n// ----- Functions -------------------------------------------------------------\n\n/**\n * Resolves with a list of StickerPackPartial objects.\n */\nexport async function getStickerPackDirectory(): Promise<Array<StickerPackPartial>> {\n  if (!stickerPackDirectoryPromise) {\n    stickerPackDirectoryPromise = new Promise(async (resolve, reject) => {\n      const res = await axios.request<Array<StickerPackPartial>>({\n        method: 'GET',\n        url: 'stickerData.json'\n      });\n\n      resolve(res.data);\n    });\n  }\n\n  return stickerPackDirectoryPromise;\n}\n\n\n/**\n * Provided a sticker pack ID and optional key, queries the Signal API and\n * resolves with 'full' StickerPack object.\n */\nexport async function getStickerPack(id: string, key?: string): Promise<StickerPack> {\n  try {\n    if (!stickerPackCache.has(id)) {\n      const directory = await getStickerPackDirectory();\n\n      // Build the metadata object using information from a StickerPackPartial\n      // in the directory or, if the requested sticker pack is unlisted, just\n      // the id and key.\n      const partial = R.find(R.pathEq(['meta', 'id'], id), directory);\n      const meta = partial ? partial.meta : {id, key};\n\n      const finalKey = key ?? meta.key;\n\n      if (!finalKey) {\n        throw new ErrorWithCode('NO_KEY_PROVIDED', `No key provided for unlisted pack: ${id}.`);\n      }\n\n      const manifest = await getStickerPackManifest(id, finalKey);\n\n      const stickerPack: StickerPack = {\n        meta,\n        manifest\n      };\n\n      stickerPackCache.set(id, stickerPack);\n    }\n\n    return stickerPackCache.get(id) as StickerPack;\n  } catch (err) {\n    if (err.isAxiosError && err.response.status === 403) {\n      throw new ErrorWithCode('MANIFEST_DECRYPT', `[getStickerPack] ${err.stack}`);\n    }\n\n    throw new ErrorWithCode(err.code, `[getStickerPack] ${err.stack}`);\n  }\n}\n\n\n/**\n * [private]\n *\n * Returns true if the provided error was thrown because the browser is blocking\n * use of local storage and/or other storage backends.\n */\nfunction isStorageUnavailableError(err: any) {\n  const patterns = [\n    // Firefox in private mode.\n    /the quota has been exceeded/ig\n  ];\n\n  if (err && err.message) {\n    return Boolean(R.find(curPattern => R.test(curPattern, err.message), patterns));\n  }\n\n  return false;\n}\n\n\n/**\n * Provided a sticker pack ID and a sticker ID (or 'cover' for the pack's cover\n * sticker) queries the Signal API and resolves with a base-64 encoded string\n * representing the image data for the indicated sticker.\n */\nexport async function getConvertedStickerInPack(id: string, key: string, stickerId: number): Promise<string> {\n  let convertedImage = '';\n\n  try {\n    const cacheKey = `${id}-${stickerId}`;\n\n    const imageFromCache = await stickerImageCache.getItem<string | undefined>(cacheKey);\n\n    if (!imageFromCache) {\n      const rawImageData = await getStickerInPack(id, key, stickerId);\n      convertedImage = await convertImage(rawImageData);\n\n      // This line may throw when in private mode in certain browsers.\n      await stickerImageCache.setItem(cacheKey, convertedImage);\n\n      return convertedImage;\n    }\n\n    return await stickerImageCache.getItem<string>(cacheKey);\n  } catch (err) {\n    if (!isStorageUnavailableError(err)) {\n      throw new Error(`[getConvertedStickerInPack] Error getting sticker: ${err.message}`);\n    }\n  }\n\n  // This should only be reachable if we got a \"storage unavailable error\", in\n  // which case return the converted image.\n  return convertedImage;\n}\n\n\n/**\n * Performs a fuzzy search on cached StickerPack data and returns the result\n * set.\n */\nexport function fuzzySearchStickerPacks(needle: string, haystack: Array<StickerPack>): Array<StickerPack> {\n  const searchKeys = ['manifest.title', 'manifest.author', 'meta.tags'];\n  const searcher = new FuzzySearch(haystack, searchKeys, {caseSensitive: false, sort: true});\n  return searcher.search(needle);\n}\n\n\nexport {\n  getEmojiForSticker\n};\n","// ===== Signal Stickers Module ================================================\n\n/**\n * This module contains several functions for loading, fetching, decrypting, and\n * caching sticker manifests and images from the Signal API.\n */\nimport axios from 'axios';\nimport protobuf from 'protobufjs';\n\nimport StickersProto from 'etc/stickers-proto';\nimport {StickerPackManifest} from 'etc/types';\nimport {decryptManifest} from 'lib/crypto';\nimport ErrorWithCode from 'lib/error';\n\n\n// ----- Locals ----------------------------------------------------------------\n\n/**\n * gRPC type definition for Signal's sticker pack manifests.\n */\nconst packMessage = protobuf.Root.fromJSON(StickersProto).root.lookupType('Pack');\n\n\n/**\n * In-memory cache of sticker pack manifests. Helps us avoid making un-necessary\n * network requests.\n */\nconst stickerPackManifestCache = new Map<string, Promise<StickerPackManifest>>();\n\n\n/**\n * In-memory cache of sticker image data. Helps us avoid making un-necessary\n * network requests.\n */\nconst stickerImageCache = new Map<string, Promise<Uint8Array>>();\n\n\n// ----- Functions -------------------------------------------------------------\n\n/**\n * Provided a key and an encrypted manifest from the Signal API, resolves with a\n * decrypted and parsed manifest.\n */\nasync function parseManifest(key: string, rawManifest: any): Promise<StickerPackManifest> {\n  try {\n    const manifest = await decryptManifest(key, rawManifest);\n    const manifestData = new Uint8Array(manifest, 0, manifest.byteLength);\n    return packMessage.decode(manifestData) as unknown as StickerPackManifest;\n  } catch (err) {\n    throw new ErrorWithCode(err.code || 'MANIFEST_PARSE', `[parseManifest] ${err.stack}`);\n  }\n}\n\n\n/**\n * Provided a sticker pack ID and key, queries the Signal API and resolves with\n * a sticker pack manifest.\n */\nexport async function getStickerPackManifest(id: string, key: string): Promise<StickerPackManifest> {\n  if (!stickerPackManifestCache.has(id)) {\n    stickerPackManifestCache.set(id, new Promise(async (resolve, reject) => {\n      try {\n        const res = await axios({\n          method: 'GET',\n          responseType: 'arraybuffer',\n          url: `https://cdn-ca.signal.org/stickers/${id}/manifest.proto`\n        });\n\n        const manifest = await parseManifest(key, res.data);\n\n        resolve(manifest);\n      } catch (err) {\n        reject(err);\n      }\n    }));\n  }\n\n  return stickerPackManifestCache.get(id) as Promise<StickerPackManifest>;\n}\n\n\n/**\n * Provided a sticker pack ID and a sticker ID (or 'cover' for the pack's cover\n * sticker) queries the Signal API and resolves with the raw WebP image data for\n * the indicated sticker.\n *\n * Note: Web users who want to use this data to render an image will need to\n * prefix this string with \"data:image/webp;base64,\".\n */\nexport async function getStickerInPack(id: string, key: string, stickerId: number): Promise<Uint8Array> {\n  const cacheKey = `${id}-${stickerId}`;\n\n  if (!stickerImageCache.has(cacheKey)) {\n    stickerImageCache.set(cacheKey, new Promise(async (resolve, reject) => {\n      try {\n        const res = await axios({\n          method: 'GET',\n          responseType: 'arraybuffer',\n          url: `https://cdn-ca.signal.org/stickers/${id}/full/${stickerId}`\n        });\n\n        const stickerManifest = await decryptManifest(key, res.data);\n        const rawWebpData = new Uint8Array(stickerManifest, 0, stickerManifest.byteLength);\n\n        resolve(rawWebpData);\n      } catch (err) {\n        reject(err);\n      }\n    }));\n  }\n\n  return stickerImageCache.get(cacheKey) as Promise<Uint8Array>;\n}\n\n\n/**\n * Provided a sticker pack ID, key, and sticker ID, returns the emoji associated\n * with the sticker.\n */\nexport async function getEmojiForSticker(id: string, key: string, stickerId: number): Promise<string> {\n  const packManifest = await getStickerPackManifest(id, key);\n\n  const sticker = packManifest.stickers.find(curSticker => curSticker.id === stickerId);\n\n  if (!sticker) {\n    throw new Error(`Sticker pack ${id} has no sticker with ID ${stickerId}.`);\n  }\n\n  return sticker.emoji;\n}\n","export default {\n  nested: {\n    Pack: {\n      fields: {\n        title: {\n          type: 'string',\n          id: 1\n        },\n        author: {\n          type: 'string',\n          id: 2\n        },\n        cover: {\n          type: 'Sticker',\n          id: 3\n        },\n        stickers: {\n          rule: 'repeated',\n          type: 'Sticker',\n          id: 4,\n          options: {}\n        }\n      },\n      nested: {\n        Sticker: {\n          fields: {\n            id: {\n              type: 'uint32',\n              id: 1\n            },\n            emoji: {\n              type: 'string',\n              id: 2\n            }\n          }\n        }\n      }\n    }\n  }\n};\n","import React, {createContext, PropsWithChildren, useEffect, useState} from 'react';\nimport * as R from 'ramda';\nimport useAsyncEffect from 'use-async-effect';\n\nimport {StickerPack} from 'etc/types';\nimport {\n  getStickerPackDirectory,\n  getStickerPack,\n  fuzzySearchStickerPacks\n} from 'lib/stickers';\n\n\n/**\n * Shape of the object provided by this Context.\n */\nexport interface StickersProviderContext {\n  /**\n   * List of all sticker packs known to the application.\n   */\n  allStickerPacks: Array<StickerPack> | undefined;\n\n  /**\n   * Current search query. This is persisted here so that should the user return\n   * to the search page, their query and results will be preserved.\n   */\n  searchQuery: string;\n\n  /**\n   * Current result set based on the current value of search Query.\n   */\n  searchResults: Array<StickerPack>;\n\n  /**\n   * Allows a consumer to set the current search query, which will in turn\n   * update the current search results.\n   */\n  setSearchQuery(needle: string): void;\n}\n\n\nconst Context = createContext<StickersProviderContext>({} as any);\n\n\nexport const Provider = (props: PropsWithChildren<{}>) => {\n  const [searchQuery, setSearchQuery] = useState('');\n  const [searchResults, setSearchResults] = useState<Array<StickerPack>>([]);\n  const [allStickerPacks, setAllStickerPacks] = useState<Array<StickerPack>>();\n\n\n  /**\n   * [Effect] When the component/context mounts, set the list of sticker\n   * packs from stickerData.json and setup the initial search results.\n   */\n  useAsyncEffect(async () => {\n    // Load the set of sticker packs we need from stickerData.json.\n    const stickerPacks = await getStickerPackDirectory();\n\n    // Set the canonical list of all sticker packs.\n    setAllStickerPacks(stickerPacks);\n\n    // Finally, set our search results to the set of all sticker packs,\n    // using the default sort order (most recently added first).\n    setSearchResults(stickerPacks);\n  }, []);\n\n\n  /**\n   * [Effect] Update `searchResults` when `searchQuery` changes.\n   */\n  useEffect(() => {\n    if (!allStickerPacks) {\n      return;\n    }\n\n    const rawSearchResults = fuzzySearchStickerPacks(searchQuery, allStickerPacks);\n\n    // Only call `setSearchResults` if our new results have actually changed.\n    // This will save us superfluous re-renders.\n    if (!R.equals(rawSearchResults, searchResults)) {\n      setSearchResults(rawSearchResults);\n    }\n  }, [searchQuery]);\n\n\n  // ----- Render --------------------------------------------------------------\n\n  return (\n    <Context.Provider value={{\n      allStickerPacks,\n      searchQuery,\n      setSearchQuery,\n      searchResults\n    }}>{props.children}</Context.Provider>\n  );\n};\n\n\nexport default Context;\n","import debounceFn from 'debounce-fn';\nimport {cx} from 'linaria';\nimport {styled} from 'linaria/react';\nimport React, {useContext, useState, useEffect} from 'react';\n// @ts-ignore (No type definitions exist for this package.)\nimport Octicon from 'react-octicon';\nimport useBreakpoint from 'use-breakpoint';\n\nimport {SIGNAL_BLUE} from 'etc/colors';\nimport {BOOTSTRAP_BREAKPOINTS} from 'etc/constants';\nimport StickersContext from 'contexts/StickersContext';\n\n\n// ----- Styles ----------------------------------------------------------------\n\nconst SearchInput = styled.div`\n  & .octicon-search {\n    color: ${SIGNAL_BLUE};\n    font-size: 14px;\n    position: relative;\n    left: -1px;\n  }\n\n  & .input-group-lg {\n    & .octicon {\n      font-size: 24px;\n    }\n\n    & input {\n      font-weight: 400;\n    }\n  }\n\n  & .badge-signal{\n    color: ${SIGNAL_BLUE};\n    border: 1px solid ${SIGNAL_BLUE};\n    margin-right: 5px;\n  }\n`;\n\n// ----- Component -------------------------------------------------------------\n\nconst SearchInputComponent: React.FunctionComponent = () => {\n  const {allStickerPacks, searchQuery, setSearchQuery} = useContext(StickersContext);\n  const [searchQueryInputValue, setSearchQueryInputValue] = useState('');\n  const {breakpoint} = useBreakpoint(BOOTSTRAP_BREAKPOINTS, 'xl');\n  const suggestedTags = ['cute', 'privacy', 'meme', 'for children'];\n\n\n  /**\n   * Allows us to de-bounce calls to setSearchQuery to avoid making excessive\n   * re-renders when the input value is updated.\n   */\n  const debouncedSetSearchQuery = debounceFn((value: string) => {\n    setSearchQuery(value);\n  }, {wait: 250});\n\n\n  /**\n   * [Event Handler] Updates our context's search query state.\n   */\n  function onSearchQueryInputChange(event: React.ChangeEvent<HTMLInputElement>) {\n    const {value} = event.target;\n    setSearchQueryInputValue(value);\n  }\n\n  function onTagClick(event: React.SyntheticEvent) {\n    setSearchQueryInputValue(event.currentTarget.textContent);\n  }\n\n  const tags = suggestedTags.map(tag =>\n    <a href=\"#\" className=\"badge badge-signal\" onClick={onTagClick}>{tag}</a>\n  );\n\n  /**\n   * [Event Handler] Clears our context's search query state.\n   */\n  function clearSearchResults(event: React.SyntheticEvent) {\n    event.preventDefault();\n    setSearchQueryInputValue('');\n    setSearchQuery('');\n  }\n\n\n  /**\n   * [Effect] When the component mounts, set the search input's value to the\n   * current search query from our context.\n   */\n  useEffect(() => {\n    if (searchQuery) {\n      setSearchQueryInputValue(searchQuery);\n    }\n  }, []);\n\n\n  /**\n   * [Effect] When the search query is updated, call our de-bounced update\n   * function.\n   */\n  useEffect(() => {\n    debouncedSetSearchQuery.cancel();\n    debouncedSetSearchQuery(searchQueryInputValue);\n\n    return () => {\n      debouncedSetSearchQuery.cancel();\n    };\n  }, [searchQueryInputValue]);\n\n\n  // ----- Render --------------------------------------------------------------\n\n  const placeholder = allStickerPacks ? `Search ${allStickerPacks.length} sticker packs...` : '';\n\n  return (\n    <SearchInput className=\"row mb-4 mb-md-5\">\n      <div className=\"col-12\">\n        <div className=\"form-group m-0\">\n          <div className={cx('input-group', ['md', 'lg', 'xl'].includes(breakpoint) && 'input-group-lg')}>\n            <div className=\"input-group-prepend\">\n              <span className=\"input-group-text\">\n                <Octicon name=\"search\" />\n              </span>\n            </div>\n            <input\n              type=\"text\"\n              key=\"search\"\n              className=\"form-control\"\n              onChange={onSearchQueryInputChange}\n              value={searchQueryInputValue}\n              placeholder={placeholder}\n              title=\"Search\"\n              aria-label=\"search\"\n              autoComplete=\"false\"\n              spellCheck=\"false\"\n            />\n            <div className=\"input-group-append\">\n              <button className=\"input-group-text btn btn-light btn-sm\" onClick={clearSearchResults} title=\"Clear Search Results\">\n                &nbsp;<Octicon name=\"x\" className=\"text-danger\" />\n              </button>\n            </div>\n          </div>\n        </div>\n        <br/>\n        <div>\n          <small>Lost? Why not start with these tags?</small> {tags}\n        </div>\n      </div>\n    </SearchInput>\n  );\n};\n\n\nexport default SearchInputComponent;\n","import React, {useState} from 'react';\nimport {styled} from 'linaria/react';\n// @ts-ignore (No type definitions exist for this package.)\nimport Octicon from 'react-octicon';\nimport useAsyncEffect from 'use-async-effect';\n\nimport {StickerPackPartial} from 'etc/types';\nimport {getConvertedStickerInPack} from 'lib/stickers';\n\n\n// ----- Props -----------------------------------------------------------------\n\nexport interface Props {\n  stickerPack: StickerPackPartial;\n}\n\n\n// ----- Styles ----------------------------------------------------------------\n\nconst StickerPackPreviewCard = styled.div<React.ComponentProps<'div'> & {nsfw?: boolean}>`\n  text-align: center;\n  transition: box-shadow 0.15s ease-in-out;\n\n  & .card-img-top {\n    height: 72px;\n    width: 72px;\n    object-fit: contain;\n    margin-top: 24px;\n    margin-bottom: 24px;\n    margin-left: auto;\n    margin-right: auto;\n    transition: transform 0.15s ease-in;\n    filter: ${props => props.nsfw ? 'blur(4px)' : 'none'};\n  }\n\n  & .card-header {\n    border-bottom: none;\n    border-top: 1px solid rgba(0, 0, 0, 0.125);\n    color: black;\n    font-size: 14px;\n    font-weight: 400;\n    white-space: nowrap;\n    overflow: hidden;\n    position: relative;\n\n    &::after {\n      background: linear-gradient(90deg, rgba(247, 247, 247, 0) 0%, rgba(247, 247, 247, 1) 50%);\n      border-bottom-right-radius: 4px;\n      bottom: 0;\n      content: ' ';\n      display: block;\n      pointer-events: none;\n      position: absolute;\n      right: 0;\n      top: 0;\n      width: 15%;\n    }\n  }\n\n  &:hover {\n    * {\n      color: black;\n    }\n\n    & .card-img-top {\n      transform: scale(1.1)\n    }\n\n    box-shadow: 1px 1px 4px rgba(0, 0, 0, 0.2);\n  }\n`;\n\n\n// ----- Component -------------------------------------------------------------\n\nconst StickerPackPreviewCardComponent: React.FunctionComponent<Props> = props => {\n  const [cover, setCover] = useState<string | undefined>();\n  const {meta, manifest} = props.stickerPack;\n\n\n  /**\n   * [Effect] Loads a sticker pack's cover image when the component mounts.\n   */\n  useAsyncEffect(async () => {\n    try {\n      if (meta.id !== undefined) { // tslint:disable-line strict-type-predicates\n        const coverImage = await getConvertedStickerInPack(meta.id, meta.key, manifest.cover.id);\n        setCover(coverImage);\n      }\n    } catch (err) {\n      console.error(`[StickerPackPreviewCard::Effect::GetCover] ${err.message}`);\n    }\n  }, []);\n\n\n  // ----- Render --------------------------------------------------------------\n\n  const title = [manifest.title, meta.nsfw && ' (NSFW)'].filter(Boolean).join('');\n\n  return (\n    <StickerPackPreviewCard className=\"card\" nsfw={meta.nsfw} aria-label={title}>\n      {cover ? <img className=\"card-img-top\" src={cover} /> : <div className=\"card-img-top\"></div>}\n      <div className=\"card-header\">{title}</div>\n    </StickerPackPreviewCard>\n  );\n};\n\n\nexport default StickerPackPreviewCardComponent;\n","import {styled} from 'linaria/react';\nimport React, {useState, useContext, useEffect} from 'react';\nimport {Link} from 'react-router-dom';\nimport {Waypoint} from 'react-waypoint';\nimport * as R from 'ramda';\nimport useAsyncEffect from 'use-async-effect';\n\nimport StickerContext from 'contexts/StickersContext';\nimport {StickerPack} from 'etc/types';\nimport StickerPackPreviewCard from './StickerPackPreviewCard';\n\n\n// ----- Styles ----------------------------------------------------------------\n\nconst StickerPackList = styled.div`\n  & a {\n    &:hover {\n      text-decoration: none;\n    }\n  }\n`;\n\n\n// ----- Component -------------------------------------------------------------\n\n/**\n * How many items we will load each time loadMore() is called.\n */\nconst PAGE_SIZE = 64;\n\n\nconst StickerPackListComponent = () => {\n  const {searchResults} = useContext(StickerContext);\n  // Used by Waypoint to persist the component across re-renders.\n  const [cursor, setCursor] = useState(0);\n  // Subset of total search results that have been rendered.\n  const [renderedSearchResults, setRenderedSearchResults] = useState<Array<StickerPack>>([]);\n\n\n  /**\n   * Adds PAGE_SIZE items from searchResults to renderedSearchResults and\n   * updates the cursor.\n   */\n  async function loadMore() {\n    // If we have rendered all search results, bail.\n    if (renderedSearchResults.length >= searchResults.length) {\n      return;\n    }\n\n    const newCursor = cursor + PAGE_SIZE;\n    setCursor(newCursor);\n    setRenderedSearchResults(R.take(newCursor, searchResults));\n  }\n\n\n  /**\n   * [Effect] When the list of search results is updated, re-set our rendered\n   * search results and cursor.\n   */\n  useAsyncEffect(async () => {\n    setCursor(0);\n    setRenderedSearchResults([]);\n    await loadMore();\n  }, [searchResults]);\n\n\n  // ----- Render --------------------------------------------------------------\n\n  return (\n    <StickerPackList className=\"row\">\n      {renderedSearchResults.map(({meta, manifest}) => (\n        <Link className=\"col-6 col-md-4 col-lg-3 mb-4\" key={meta.id} to={`/pack/${meta.id}`}>\n          <StickerPackPreviewCard stickerPack={{meta, manifest}} />\n        </Link>\n      ))}\n      <Waypoint key={cursor} onEnter={loadMore} bottomOffset=\"-500px\" />\n    </StickerPackList>\n  );\n};\n\n\nexport default StickerPackListComponent;\n","import React from 'react';\n\nimport SearchInput from './SearchInput';\nimport StickerPackList from './SearchResults';\n\n\nconst HomeComponent: React.FunctionComponent = () => {\n  return (\n    <div className=\"mt-4 mt-md-5 mb-5\">\n      <p className=\"pb-2 pb-md-4\">\n        Welcome to Signal Stickers, the unofficial directory for Signal sticker\n        packs. You can filter packs by title, author, or tags.\n      </p>\n      <SearchInput />\n      <StickerPackList />\n    </div>\n  );\n};\n\n\nexport default HomeComponent;\n","import React, {useState} from 'react';\nimport {styled} from 'linaria/react';\n// @ts-ignore (No type definitions exist for this package.)\nimport Octicon from 'react-octicon';\nimport useAsyncEffect from 'use-async-effect';\n\nimport {getConvertedStickerInPack, getEmojiForSticker} from 'lib/stickers';\n\n\n// ----- Props -----------------------------------------------------------------\n\nexport interface Props {\n  packId: string;\n  packKey: string;\n  stickerId: number;\n}\n\n\n// ----- Styles ----------------------------------------------------------------\n\nconst Sticker = styled.div`\n  border: 1px solid rgba(0, 0, 0, .125);\n  border-radius: 4px;\n  position: relative;\n\n  & .emoji {\n    position: absolute;\n    top: 2px;\n    left: 6px;\n    opacity: 0.75;\n  }\n\n  & img {\n    width: 72px;\n    height: 72px;\n    object-fit: contain;\n  }\n\n  @media screen and (min-width: 576px) {\n    & img {\n      width: 128px;\n      height: 128px;\n    }\n  }\n`;\n\n\n// ----- Component -------------------------------------------------------------\n\nconst StickerComponent: React.FunctionComponent<Props> = ({packId, packKey, stickerId}) => {\n  const [emoji, setEmoji] = useState('');\n  const [stickerSrc, setStickerSrc] = useState('');\n\n\n  /**\n   * [Effect] Load sticker data and emoji for the sticker indicated in our\n   * props.\n   */\n  useAsyncEffect(async () => {\n    const [\n      emojiResult,\n      stickerResult\n    ] = await Promise.all([\n      getEmojiForSticker(packId, packKey, stickerId),\n      getConvertedStickerInPack(packId, packKey, stickerId)\n    ]);\n\n    setEmoji(emojiResult);\n    setStickerSrc(stickerResult);\n  }, []);\n\n\n  // ----- Render --------------------------------------------------------------\n\n  if (!emoji || !stickerSrc) {\n    return null; // tslint:disable-line no-null-keyword\n  }\n\n  return (\n    <Sticker className=\"shadow-sm m-3 p-4\">\n      <div className=\"emoji\">{emoji}</div>\n      <img src={stickerSrc} alt=\"Sticker\" />\n    </Sticker>\n  );\n};\n\n\nexport default StickerComponent;\n","import React from 'react';\n\n\nconst StickerPackError: React.FunctionComponent = props => {\n  return (\n    <div className=\"p-4 my-4\">\n      <div className=\"row mb-4\">\n        <div className=\"col-10 offset-1 alert alert-danger\">\n          <h3 className=\"alert-heading mt-1 mb-3\">Error</h3>\n          {props.children}\n        </div>\n      </div>\n    </div>\n  );\n};\n\n\nexport default StickerPackError;\n","import React from 'react';\n\n\nconst Tag: React.FunctionComponent = props => {\n  return (\n    <div className=\"badge badge-primary mr-1\">\n      {props.children}\n    </div>\n  );\n};\n\n\nexport default Tag;\n","import React, {useState} from 'react';\nimport {Link, useParams} from 'react-router-dom';\nimport Linkify from 'react-linkify';\nimport {styled} from 'linaria/react';\nimport {darken} from 'polished';\n// @ts-ignore (No type definitions exist for this package.)\nimport Octicon from 'react-octicon';\nimport useAsyncEffect from 'use-async-effect';\n\nimport {GRAY, SIGNAL_BLUE} from 'etc/colors';\nimport {StickerPack} from 'etc/types';\nimport useQuery from 'hooks/use-query';\nimport {getStickerPack} from 'lib/stickers';\n\nimport Sticker from './Sticker';\nimport StickerPackError from './StickerPackError';\nimport Tag from './Tag';\n\n\n// ----- Types -----------------------------------------------------------------\n\n/**\n * URL parameters that we expect to have set when this component is rendered.\n */\nexport interface UrlParams {\n  packId: string;\n}\n\n\n// ----- Styles ----------------------------------------------------------------\n\nconst StickerPackDetail = styled.div`\n  background-color: white;\n\n  @media screen and (min-width: 576px) {\n    border-radius: 4px;\n    border: 1px solid ${darken(0.15, GRAY)};\n  }\n\n  & .list-group-item {\n    align-items: center;\n    display: flex;\n    flex-direction: row;\n    font-size: 14px;\n\n    & .octicon {\n      font-size: 20px;\n      margin-right: 20px;\n    }\n  }\n\n  & .octicon-globe {\n    color: ${SIGNAL_BLUE};\n  }\n\n  & .octicon-file-directory {\n    color: ${SIGNAL_BLUE};\n  }\n\n  & .octicon-alert {\n    color: ${SIGNAL_BLUE};\n  }\n\n  & .octicon-tag {\n    color: ${SIGNAL_BLUE};\n  }\n\n  & .title {\n    font-size: 32px;\n    font-weight: 600;\n  }\n\n  @media screen and (min-width: 768px) {\n    & .list-group-item {\n      font-size: inherit;\n\n      & .octicon {\n        font-size: 20px;\n        margin-right: 20px;\n      }\n    }\n\n    & .title {\n      font-size: 42px;\n      font-weight: 600;\n    }\n  }\n\n  & .author {\n    font-size: 16px;\n    font-weight: 400;\n    opacity: 0.6;\n  }\n\n  & strong {\n    font-weight: 600;\n  }\n`;\n\n\n// ----- Component -------------------------------------------------------------\n\n/**\n * Custom component for Linkify links that adds \"target\" and \"rel\" attributes.\n */\nfunction LinkifyHrefDecorator(decoratedHref: string, decoratedText: string, key: number) {\n  return (\n    <a href={decoratedHref} key={key} target=\"_blank\" rel=\"noreferrer\">{decoratedText}</a>\n  );\n}\n\n\nconst StickerPackDetailComponent: React.FunctionComponent = () => {\n  // Extract :packId from the URL.\n  const {packId} = useParams<UrlParams>();\n\n  // Extract the optional \"key\" query param from the URL.\n  const key = useQuery().get('key') || undefined;\n\n  // StickerPack object for the requested pack.\n  const [stickerPack, setStickerPack] = useState<StickerPack>();\n\n  // One of many possible error codes we may catch when trying to load or\n  // decrypt a sticker pack. This will be used to determine what error message\n  // to show the user.\n  const [stickerPackError, setStickerPackError] = useState('');\n\n\n  /**\n   * [Effect] Set `stickerPack` when the component mounts.\n   */\n  useAsyncEffect(async () => {\n    try {\n      if (!packId) {\n        return;\n      }\n\n      setStickerPack(await getStickerPack(packId, key));\n    } catch (err) {\n      if (err.code) {\n        setStickerPackError(err.code);\n      }\n    }\n  }, []);\n\n\n  // ----- Render --------------------------------------------------------------\n\n  if (!packId || !stickerPack) {\n    // If an error code has been set, display an error alert to the user.\n    if (stickerPackError) {\n      switch (stickerPackError) {\n        case 'NO_KEY_PROVIDED':\n          return (\n            <StickerPackError>\n              <p>This sticker pack is not listed in the Signal Stickers directory. However, if you have the pack's <strong>key</strong>, you can still preview the sticker pack by supplying a <code>key</code> parameter in the URL.</p>\n              <p>For example: <code>{`/pack/${packId}?key=sticker-pack-key`}</code></p>\n            </StickerPackError>\n          );\n        case 'MANIFEST_DECRYPT':\n          return (\n            <StickerPackError>\n              <p>The provided key is invalid.</p>\n            </StickerPackError>\n          );\n        default:\n          return (\n            <StickerPackError>\n              <p>An unknown error occurred ({stickerPackError}).</p>\n            </StickerPackError>\n          );\n      }\n    }\n\n    // If we don't have an error, we're likely still waiting on an async\n    // operation, so render nothing.\n    return null; // tslint:disable-line no-null-keyword\n  }\n\n  const source = stickerPack.meta.source || 'N/A';\n  const numStickers = stickerPack.manifest.stickers.length;\n  // N.B. Signal allows strings containing only whitespace as authors. In these\n  // cases, use 'Anonymous' instead.\n  const author = stickerPack.manifest.author.trim() ? stickerPack.manifest.author : 'Anonymous';\n  const stickerPackTags = stickerPack.meta.tags || [];\n  const addToSignalHref = `https://signal.art/addstickers/#pack_id=${packId}&pack_key=${stickerPack.meta.key}`;\n\n\n  // TODO: Fix logic around displaying home button to better detect when we're\n  // viewing an unlisted sticker pack.\n  return (\n    <StickerPackDetail className=\"px-1 px-sm-4 py-4 mt-0 mt-sm-5 mb-5\">\n      <div className=\"row mb-4 flex-column-reverse flex-lg-row\">\n        <div className=\"col-12 col-lg-8 mt-4 mt-lg-0\">\n          <div className=\"title\">{stickerPack.manifest.title}</div>\n          <div className=\"author\">{author}</div>\n        </div>\n        <div className=\"col-12 col-lg-4 d-flex d-lg-block justify-content-between text-md-right\">\n          {stickerPack.meta ? <Link to=\"/\">\n            <button type=\"button\" className=\"btn btn-link mr-2\">\n              Home\n            </button>\n          </Link> : null}\n          <a href={addToSignalHref} target=\"_blank\" rel=\"noreferrer\" title=\"Add to Signal\">\n            <button className=\"btn btn-primary\">\n              <Octicon name=\"plus\" />&nbsp;Add to Signal\n            </button>\n          </a>\n        </div>\n      </div>\n\n      {stickerPack.meta ? <div className=\"row mb-4\">\n        <div className=\"col-12 col-lg-6\">\n          <ul className=\"list-group\">\n            <li className=\"list-group-item text-wrap text-break\">\n              <Octicon name=\"globe\" title=\"Source\" />\n              <div>\n                <Linkify componentDecorator={LinkifyHrefDecorator}>{source}</Linkify>\n              </div>\n            </li>\n            <li className=\"list-group-item text-wrap text-break\">\n              <Octicon name=\"file-directory\" title=\"Sticker Count\" />\n              {numStickers}\n            </li>\n            {stickerPack.meta.nsfw ? <li className=\"list-group-item text-wrap text-break\">\n              <Octicon name=\"alert\" title=\"NSFW\" /> <strong>NSFW</strong>\n            </li> : null}\n            <li className=\"list-group-item\">\n              <Octicon name=\"tag\" title=\"Tags\" />\n              <div className=\"text-wrap text-break\">\n                {stickerPackTags.length === 0 ? 'None' : stickerPackTags.map(tag => (<Tag key={tag}>{tag}</Tag>))}\n              </div>\n            </li>\n          </ul>\n        </div>\n      </div> : null}\n\n      <div className=\"row\">\n        <div className=\"col-12\">\n          <div className=\"d-flex flex-wrap justify-content-around\">\n            {stickerPack.manifest.stickers.map(sticker => (<Sticker packId={packId} packKey={stickerPack.meta.key} stickerId={sticker.id} key={sticker.id} />))}\n          </div>\n        </div>\n      </div>\n    </StickerPackDetail>\n  );\n};\n\n\nexport default StickerPackDetailComponent;\n","import {useLocation} from 'react-router-dom';\n\n\n/**\n * Custom hook for introspecting URL query parameters.\n *\n * Example usage:\n *\n * const query = useQuery();\n * query.get('foo');\n */\nexport default function useQuery() {\n  return new URLSearchParams(useLocation().search);\n}\n","import {styled} from 'linaria/react';\n\n\n/**\n * This component can be used to take up unused space across a flex axis.\n */\nexport default styled.div`\n  flex-grow: 1;\n`;\n","import React from 'react';\nimport {styled} from 'linaria/react';\nimport {darken} from 'polished';\n// @ts-ignore (No type definitions exist for this package.)\nimport Octicon from 'react-octicon';\n\nimport {GRAY} from 'etc/colors';\nimport FlexSpacer from 'components/layout/FlexSpacer';\n\n\n// ----- Styles ----------------------------------------------------------------\n\nconst FooterWrapper = styled.footer`\n  background-color: ${GRAY};\n  border-top: 1px solid ${darken(0.05, GRAY)};\n  width: 100%;\n`;\n\nconst Footer = styled.div`\n  & ul {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n  }\n\n  & h1 {\n    font-size: 32px;\n    font-weight: 400;\n  }\n\n  & a {\n    font-size: 14px;\n  }\n\n  & p {\n    font-size: 14px;\n    font-weight: 300;\n  }\n\n  & strong {\n    font-weight: 400;\n  }\n\n  @media screen and (min-width: 768px) {\n    & a {\n      font-size: 16px;\n    }\n\n    & p {\n      font-size: 16px;\n    }\n  }\n`;\n\n\n// ----- Component -------------------------------------------------------------\n\nconst FooterComponent: React.FunctionComponent = props => {\n  return (\n    <>\n      <FlexSpacer />\n      <FooterWrapper>\n        <div className=\"container\">\n          <Footer className=\"row pt-5 pb-3\">\n            <div className=\"col-12 col-md-6 about\">\n              <h1 className=\"mb-4\">About</h1>\n              <p>\n                Browse and download more than 1000 sticker packs for Signal, the secure messenger. These\n                stickers are created by the community; the maintainers of this website do not claim any\n                rights. <strong>This site is not affiliated with Signal</strong>.\n              </p>\n              <p>\n                <a href=\"https://twitter.com/search?q=%23makeprivacystick&src=typed_query\" rel=\"noreferrer\" target=\"_blank\">\n                  <strong>#makeprivacystick</strong>\n                </a>\n              </p>\n            </div>\n            <div className=\"col-12 col-md-6 links\">\n              <h1 className=\"mb-4\">Links</h1>\n              <ul>\n                <li>\n                  <a href=\"https://signal.org\" rel=\"noreferrer\" target=\"_blank\">\n                    <Octicon name=\"link-external\" /> Learn More About Signal\n                  </a>\n                </li>\n                <li>\n                  <a href=\"https://github.com/romainricard/signalstickers\" rel=\"noreferrer\" target=\"_blank\">\n                    <Octicon name=\"link-external\" /> GitHub Repository\n                  </a>\n                </li>\n                <li>\n                  <a href=\"https://github.com/romainricard/signalstickers/issues/new\" rel=\"noreferrer\" target=\"_blank\">\n                    <Octicon name=\"link-external\" /> Report an Issue\n                  </a>\n                </li>\n                <li>\n                  <a href=\"https://support.signal.org/hc/en-us/articles/360031836512-Stickers#h_c2a0a45b-862f-4d12-9ab1-d9a6844062ca\" rel=\"noreferrer\" target=\"_blank\">\n                    <Octicon name=\"link-external\" /> Sticker Pack Creation Guide\n                  </a>\n                </li>\n              </ul>\n            </div>\n          </Footer>\n        </div>\n      </FooterWrapper>\n    </>\n  );\n};\n\n\nexport default FooterComponent;\n","import {Formik, Form, Field, ErrorMessage} from 'formik';\nimport {cx} from 'linaria';\nimport {styled} from 'linaria/react';\nimport {darken} from 'polished';\nimport React, {useState} from 'react';\nimport * as R from 'ramda';\nimport yaml from 'js-yaml';\n\nimport {GRAY} from 'etc/colors';\nimport {getStickerPackDirectory, getStickerPack} from 'lib/stickers';\n\n/**\n * Test pack:\n * https://signal.art/addstickers/#pack_id=b2e52b07dfb0af614436508c51aa24eb&pack_key=66224990b3e956ad4a735830df8cd071275afeae79db9797e57d99314daffc77\n */\n\n\n// ----- Styles ----------------------------------------------------------------\n\nconst Contribute = styled.div`\n  background-color: white;\n\n  @media screen and (min-width: 576px) {\n    border-radius: 4px;\n    border: 1px solid ${darken(0.15, GRAY)};\n  }\n\n  /**\n   * Ensures error feedback containers are always visible (even if empty) so\n   * that controls do not jump around as they move between valid and invalid\n   * states.\n   */\n  & .invalid-feedback {\n    display: block;\n  }\n`;\n\n\n// ----- Types -----------------------------------------------------------------\n\nexport interface FormValues {\n  signalArtUrl: string;\n  source: string;\n  tags: string;\n  isNsfw?: 'true' | 'false';\n}\n\n\n// ----- Locals ----------------------------------------------------------------\n\n/**\n * Regular expression used to validate signal.art URLs for sticker packs.\n */\nconst SIGNAL_ART_URL_PATTERN = /^https:\\/\\/signal.art\\/addstickers\\/#pack_id=([A-Za-z0-9]+)&pack_key=([A-Za-z0-9]+)$/g;\n\n/**\n * Regular expression used to validate lists of tags.\n */\nconst TAGS_PATTERN = /^(?:([\\w\\d-_ ]+))+(?:, ([\\w\\d-_ ]+))*$/g;\n\n/**\n * Initial values for the form.\n */\nconst initialValues: FormValues = {\n  signalArtUrl: '',\n  source: '',\n  tags: '',\n  isNsfw: undefined\n};\n\n/**\n * Validators for each field in our form.\n */\nconst validators = {\n  signalArtUrl: async (signalArtUrl: string) => {\n    if (!signalArtUrl) {\n      return 'This field is required.';\n    }\n\n    const matches = new RegExp(SIGNAL_ART_URL_PATTERN).exec(signalArtUrl);\n\n    if (!matches) {\n      return 'Invalid signal.art URL.';\n    }\n\n    const [, packId, packKey] = matches;\n\n    if (R.find(R.pathEq(['meta', 'id'], packId) , await getStickerPackDirectory())) {\n      return 'A sticker pack with that ID already exists in the directory.';\n    }\n\n    try {\n      await getStickerPack(packId, packKey);\n    } catch (err) {\n      return 'Invalid sticker pack. Please check the pack ID and key.';\n    }\n  },\n  source: (source: string) => {\n    if (source && source.length > 320) {\n      return 'This field must be no longer than 320 characters.';\n    }\n  },\n  tags: (tags: string) => {\n    if (tags !== '' && !(new RegExp(TAGS_PATTERN).test(tags))) {\n      return 'Invalid value. Tags must be a list of comma-delimited strings.';\n    }\n  },\n  isNsfw: (isNsfw?: boolean) => {\n    if (isNsfw === undefined) {\n      return 'This field is required.';\n    }\n  }\n};\n\n\n// ----- Component -------------------------------------------------------------\n\nconst ContributeComponent: React.FunctionComponent = () => {\n  const [hasBeenSubmitted, setHasBeenSubmitted] = useState(false);\n  const [ymlBlob, setYmlBlob] = useState('');\n  const [previewUrl, setPreviewUrl] = useState('');\n\n\n  /**\n   * Sets 'hasBeenSubmitted' when the Submit button is clicked. We need this\n   * because Formik will not call our onSubmit function when the submit button\n   * is clicked _but_ validation fails. This makes sense, but because we want to\n   * change the way validation errors are presented to the user after the first\n   * submit attempt, we need to track \"attempts\" separately.\n   */\n  const onSubmitClick = () => {\n    setHasBeenSubmitted(true);\n    setYmlBlob('');\n    setPreviewUrl('');\n  };\n\n\n  /**\n   * Called when the form is submitted and has passed validation.\n   */\n  const onSubmit: any = (values: FormValues) => {\n    const matches = new RegExp(SIGNAL_ART_URL_PATTERN).exec(values.signalArtUrl);\n\n    if (!matches) {\n      throw new Error('Unable to extract pack ID and pack key from signal.art URL.');\n    }\n\n    const [, packId, packKey] = matches;\n\n    const tags = R.uniq(values.tags\n      .split(',')\n      .map(tag => tag.trim())\n      .filter(tag => tag.length));\n\n    setYmlBlob(yaml.safeDump({\n      [packId]: {\n        key: packKey,\n        source: values.source,\n        tags,\n        nsfw: values.isNsfw === 'true' ? true : false\n      }\n    }, null, 2).trim());\n\n    setPreviewUrl(\n      `https://signalstickers.com/pack/${packId}?key=${packKey}`\n    );\n\n    return true;\n  };\n\n\n  // ----- Render --------------------------------------------------------------\n\n  return (\n    <Contribute className=\"px-1 px-md-4 py-4 mt-0 mt-md-5 mb-5\">\n      <div className=\"row\">\n        <div className=\"col-12\">\n          <p>\n            Getting your sticker pack listed in the Signal Stickers directory is\n            easy! First, paste the <code>signal.art</code> link for your sticker\n            pack, including the <code>pack_id</code> and <code>pack_key</code> values,\n            into the form below. Then, answer a few questions about your sticker\n            pack and add optional metadata.\n          </p>\n        </div>\n      </div>\n      <div className=\"row\">\n        <div className=\"col-12 col-md-8 offset-md-2 mt-4\">\n          <Formik\n            initialValues={initialValues}\n            onSubmit={onSubmit}\n            validateOnChange={hasBeenSubmitted}\n            validateOnBlur={hasBeenSubmitted}\n          >{({values, errors, isValidating, isSubmitting}) => (\n            <Form noValidate>\n\n              {/* [Field] Signal Art Url */}\n              <div className=\"form-group\">\n                <div className=\"form-row\">\n                  <label className={cx('col-12', errors.signalArtUrl && 'text-danger')} htmlFor=\"signal-art-url\">\n                    Signal Art URL:\n                    <Field\n                      type=\"text\"\n                      id=\"signal-art-url\"\n                      name=\"signalArtUrl\"\n                      validate={validators.signalArtUrl}\n                      className={cx('form-control', errors.signalArtUrl && 'is-invalid')}\n                      placeholder=\"https://signal.art/addstickers/#pack_id=<your pack id>&pack_key=<your pack key>\"\n                    />\n                    <div className=\"invalid-feedback\">\n                      <ErrorMessage name=\"signalArtUrl\" />&nbsp;\n                    </div>\n                  </label>\n                </div>\n              </div>\n\n              {/* [Field] Source */}\n              <div className=\"form-group\">\n                <div className=\"form-row\">\n                  <label className={cx('col-12', errors.source && 'text-danger')} htmlFor=\"source\">\n                    (Optional) Source:\n                    <Field\n                      type=\"text\"\n                      id=\"source\"\n                      name=\"source\"\n                      validate={validators.source}\n                      className={cx('form-control', errors.source && 'is-invalid')}\n                    />\n                    <small className=\"form-text text-muted\">Original author, website, company, etc.</small>\n                    <div className=\"invalid-feedback\">\n                      <ErrorMessage name=\"source\" />&nbsp;\n                    </div>\n                  </label>\n                </div>\n              </div>\n\n              {/* [Field] Tags */}\n              <div className=\"form-group mb-4\">\n                <div className=\"form-row\">\n                  <label className={cx('col-12', errors.tags && 'text-danger')} htmlFor=\"tags\">\n                    (Optional) Tags:\n                    <Field\n                      type=\"text\"\n                      id=\"tags\"\n                      name=\"tags\"\n                      validate={validators.tags}\n                      className={cx('form-control', errors.tags && 'is-invalid')}\n                    />\n                    <small className=\"form-text text-muted\">Comma-separated list of words.</small>\n                    <div className=\"invalid-feedback\">\n                      <ErrorMessage name=\"tags\" />&nbsp;\n                    </div>\n                  </label>\n                </div>\n              </div>\n\n              {/* [Field] NSFW */}\n              <div className=\"form-group\">\n                <div className=\"form-row\">\n                  <label className={cx('col-12', 'mb-2', errors.isNsfw && 'text-danger')}>\n                    Is your sticker pack <a href=\"https://www.urbandictionary.com/define.php?term=NSFW\" target=\"_blank\" rel=\"noreferrer\">NSFW</a>?\n                  </label>\n                </div>\n                <div className=\"form-row\">\n                  <div className=\"col-12 mb-1\">\n                    <div className=\"custom-control custom-radio\">\n                      <Field\n                        type=\"radio\"\n                        id=\"is-nsfw-true\"\n                        name=\"isNsfw\"\n                        validate={validators.isNsfw}\n                        className={cx('custom-control-input', errors.isNsfw && 'is-invalid')}\n                        value=\"true\"\n                        checked={values.isNsfw === 'true'}\n                      />\n                      <label className=\"custom-control-label\" htmlFor=\"is-nsfw-true\">\n                        Yes\n                      </label>\n                    </div>\n                  </div>\n                  <div className=\"col-12\">\n                    <div className=\"custom-control custom-radio\">\n                      <Field\n                        type=\"radio\"\n                        id=\"is-nsfw-false\"\n                        name=\"isNsfw\"\n                        validate={validators.isNsfw}\n                        className={cx('custom-control-input', errors.isNsfw && 'is-invalid')}\n                        value=\"false\"\n                        checked={values.isNsfw === 'false'}\n                      />\n                      <label className=\"custom-control-label\" htmlFor=\"is-nsfw-false\">No</label>\n                    </div>\n                    <div className=\"invalid-feedback\">\n                      <ErrorMessage name=\"isNsfw\" />&nbsp;\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* [Control] Submit */}\n              <div className=\"form-group\">\n                <div className=\"form-row\">\n                  <div className=\"col-12\">\n                    <button type=\"submit\" className=\"btn btn-primary btn-block\" disabled={isSubmitting || isValidating} onClick={onSubmitClick}>\n                      Generate YML\n                    </button>\n                  </div>\n                </div>\n              </div>\n\n            </Form>\n          )}\n          </Formik>\n        </div>\n      </div>\n\n      {/* Rendered YML Output */}\n      {ymlBlob ?\n      <>\n        <div className=\"row\">\n          <div className=\"col-12\">\n            <hr />\n            <p className=\"mt-4 mb-4\">\n              Great! Below is the YML blob you will need to add at the end of <code>stickers.yml</code> in the <a href=\"https://github.com/romainricard/signalstickers/edit/master/stickers.yml\" target=\"_blank\" rel=\"noreferrer\">Signal Stickers repository</a>.\n            </p>\n          </div>\n        </div>\n        <div className=\"row\">\n          <div className=\"col-12 col-md-10 offset-md-1\">\n            <div className=\"card\">\n              <pre className=\"p-2 mb-0\">{ymlBlob}</pre>\n            </div>\n          </div>\n        </div>\n        <div className=\"row\">\n          <div className=\"col-12\">\n            <p className=\"mt-4 mb-4\">\n              Please also include this link in your Pull Request description, as it allows us to review your pack easily!\n            </p>\n          </div>\n        </div>\n        <div className=\"row\">\n          <div className=\"col-12 col-md-10 offset-md-1\">\n            <div className=\"card\">\n              <pre className=\"p-2 mb-0\">{previewUrl}</pre>\n            </div>\n          </div>\n        </div>\n      </>\n      : null}\n    </Contribute>\n  );\n};\n\n\nexport default ContributeComponent;\n","import React from 'react';\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route\n} from 'react-router-dom';\n\nimport Navbar from 'components/layout/Navbar';\nimport Home from 'components/home/Home';\nimport StickerPackDetail from 'components/pack/StickerPackDetail';\nimport Footer from 'components/layout/Footer';\nimport {Provider as StickersContextProvider} from 'contexts/StickersContext';\nimport Contribute from 'components/contribute/Contribute';\n\n\nconst App: React.FunctionComponent = () => {\n  return (\n    <Router basename=\"/signalstickers/\">\n      <StickersContextProvider>\n        <Navbar />\n        <div className=\"container\">\n          <Switch>\n            <Route exact path=\"/\">\n              <Home />\n            </Route>\n            <Route path=\"/pack/:packId\">\n              <StickerPackDetail />\n            </Route>\n            <Route path=\"/contribute\">\n              <Contribute />\n            </Route>\n          </Switch>\n        </div>\n        <Footer />\n      </StickersContextProvider>\n    </Router>\n  );\n};\n\n\nexport default App;\n","import bytes from 'bytes';\n\n\n/**\n * Prints current storage usage and quotas to the console.\n */\nexport async function printStorageUsage() {\n  if (process.env.NODE_ENV === 'development') {\n    const storageEstimate = navigator.storage && await navigator.storage.estimate();\n\n    // The navigator.storage object is undefined when using private mode in\n    // Safari.\n    if (!storageEstimate) {\n      return;\n    }\n\n    // @ts-ignore (usageDetails is not typed correctly).\n    const idbUsage = storageEstimate?.usageDetails?.indexedDB;\n    const quota = storageEstimate.quota;\n\n    if (idbUsage && quota) {\n      const percentageUsed = ((idbUsage / quota) * 100).toFixed(2);\n      console.debug(`IndexedDB is currently using ${bytes(idbUsage)} of data, or ${percentageUsed}% of the ${bytes(quota)} quota.`);\n    }\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from 'components/App';\nimport {printStorageUsage} from 'lib/utils';\nimport './index.css';\n\n\nprintStorageUsage(); // tslint:disable-line no-floating-promises\nReactDOM.render(<App />, document.getElementById('root'));\n","// ===== Crypto Utilities ======================================================\n\n/**\n * This module contains various functions that aid in the decryption of sticker\n * pack data from Signal. Browser detection for browser support of the\n * SubtleCrypto API should probably be added at some point.\n *\n * TODO: This module, along with signal.ts, should be refactored-out into a\n * separate NPM package with separate browser/Node imports, which will allow us\n * to make this code a bit cleaner. For now, this let's us use a consistent API\n * for both environments.\n *\n * See: https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto\n */\nimport crypto from 'crypto';\nimport hkdf from 'js-crypto-hkdf';\nimport ErrorWithCode from 'lib/error';\n\n\nconst IS_BROWSER = typeof window !== 'undefined'; // tslint:disable-line\n\n\n/**\n * [private]\n *\n * Converts the provided string to a Uint8Array.\n */\nfunction hexToArrayBuffer(hexString: string) {\n  const result = [];\n  let tmpHexString = hexString;\n\n  while (tmpHexString.length >= 2) {\n    result.push(parseInt(tmpHexString.substring(0, 2), 16));\n    tmpHexString = tmpHexString.substring(2, tmpHexString.length);\n  }\n\n  return new Uint8Array(result);\n}\n\n\n/**\n * [private]\n *\n * See: https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/deriveKey\n */\nasync function deriveKeys(encodedKey: string) {\n  const hash = 'SHA-256';\n  const length = 512;\n  const salt = new ArrayBuffer(32);\n  const info = 'Sticker Pack';\n\n  if (IS_BROWSER) {\n    const masterKey = await window.crypto.subtle.importKey('raw', hexToArrayBuffer(encodedKey), 'HKDF', false, ['deriveKey']);\n\n    const algorithm: HkdfParams = {\n      name: 'HKDF',\n      hash,\n      salt,\n      info: new TextEncoder().encode(info)\n    };\n\n    const derivedKeyAlgorithm = {\n      name: 'HMAC',\n      hash,\n      length\n    };\n\n    // @ts-ignore (The typedef for the SubtleCrypto API incorrectly states that\n    // we need an HkdfCtrParams object as our first param when in fact we need a\n    // HkdfParams object.)\n    const derivedKeys = await window.crypto.subtle.deriveKey(algorithm, masterKey, derivedKeyAlgorithm, true, ['verify']);\n\n    const derivedKeyBytes = await window.crypto.subtle.exportKey('raw', derivedKeys);\n    return [derivedKeyBytes.slice(0, 32), derivedKeyBytes.slice(32, 64)];\n  } else { // tslint:disable-line unnecessary-else\n    const masterKey = Buffer.from(encodedKey, 'hex');\n    const derivedKey = (await hkdf.compute(masterKey, hash, length, info, salt as Uint8Array)).key;\n    return [derivedKey.slice(0, 32), derivedKey.slice(32, 64)];\n  }\n}\n\n\n/**\n * Decrypts a manifest returned from the Signal API using a sticker pack's\n * pack key, provided from stickers.yml.\n */\nexport async function decryptManifest(encodedKey: string, rawManifest: any) {\n  try {\n    if (IS_BROWSER) {\n      const keys = await deriveKeys(encodedKey);\n      const encryptedManifest = new Uint8Array(rawManifest);\n      const theirIv = encryptedManifest.slice(0, 16);\n      const cipherTextBody = encryptedManifest.slice(16, encryptedManifest.byteLength - 32);\n      const theirMac = encryptedManifest.slice(encryptedManifest.byteLength - 32, encryptedManifest.byteLength);\n      const combinedCipherText = encryptedManifest.slice(0, encryptedManifest.byteLength - 32);\n      const macKey = await window.crypto.subtle.importKey('raw', keys[1], {name: 'HMAC', hash: {name: 'SHA-256'}}, false, ['verify', 'sign']);\n      const isValid = await window.crypto.subtle.verify('HMAC', macKey, theirMac, combinedCipherText);\n\n      if (!isValid) {\n        throw new Error('MAC verification failed.');\n      }\n\n      const cipherKey = await window.crypto.subtle.importKey('raw', keys[0], 'AES-CBC', false, ['decrypt']);\n      return window.crypto.subtle.decrypt({name: 'AES-CBC', iv: theirIv}, cipherKey, cipherTextBody);\n    } else { // tslint:disable-line unnecessary-else\n      const [aesKey, hmacKey] = await deriveKeys(encodedKey);\n\n      // rawManifest: IV || Ciphertext || truncated MAC(IV||Ciphertext)\n      const theirIv = rawManifest.slice(0, 16);\n      const cipherTextBody = rawManifest.slice(16, rawManifest.length - 32);\n      const theirMac = rawManifest.slice(rawManifest.byteLength - 32, rawManifest.byteLength).toString('hex');\n      const combinedCipherText = rawManifest.slice(0, rawManifest.byteLength - 32);\n\n      // Validate signature\n      const computedMac = crypto.createHmac('sha256', hmacKey as any).update(combinedCipherText).digest('hex');\n      if (theirMac !== computedMac) {\n        throw new Error(`MAC verification failed.`);\n      }\n\n      const decipher = crypto.createDecipheriv('aes-256-cbc', aesKey as any, theirIv);\n      return Buffer.concat([decipher.update(cipherTextBody), decipher.final()]);\n    }\n  } catch (err) {\n    throw ErrorWithCode.from('MANIFEST_DECRYPT', err);\n  }\n}\n","export default class ErrorWithCode extends Error {\n  code: string;\n\n\n  constructor(code: string, message: string) {\n    super(message);\n    this.code = code || 'UNKNOWN';\n  }\n\n\n  static from(code: string, err: Error) {\n    const errWithCode = new ErrorWithCode(code, err.message);\n    errWithCode.stack = err.stack;\n    return errWithCode;\n  }\n}\n"],"sourceRoot":""}